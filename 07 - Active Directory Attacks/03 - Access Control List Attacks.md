## Access Control List Attacks (ACLs)

Within Active Directory, users and groups have their permissions restricted based on ACLs. ACLs contain ACEs, Access Control Entities, which stipulate what permissions and rights they have over other users and computers in the domain. For example, support users may have the "ForceChangePassword" ACE applied to them which allows them to change users passwords in the domain. Sometimes, these are overly permissive or straight up misconfigured, meaning you can abuse them for lateral movement or privilege escalation.

Honestly, Bloodhound is the ðŸ‘‘ for this. It's actually hard to look past it, so if you're able to use that, I'd recommend it. However, I'll go over using Powerview modules to get a general idea and then some manual commands using Poewrview as well.

âœ¨âœ¨ https://github.com/PowerShellMafia/PowerSploit/blob/master/Recon/PowerView.ps1 âœ¨âœ¨

Here is a great resource on attacking ACLs:

âœ¨âœ¨ https://www.ired.team/offensive-security-experiments/active-directory-kerberos-abuse/abusing-active-directory-acls-aces âœ¨âœ¨

#### Using Built-in Enumeration Modules

ðŸš© REMEMBER: These will always be more noisy than doing things with manual queries. ðŸš©


#### Manual ACL Enumeration

```powershell
Get-DomainObjectAcl -Identity Neo | ? { $_.ActiveDirectoryRights -match "GenericAll|WriteProperty|WriteDacl" -and $_.SecurityIdentifier -match "S-1-5-21-3263068140-2042698922-2891547269-[\d]{4,10}" } | select SecurityIdentifier, ActiveDirectoryRights | fl


Get-DomainObjectAcl -SearchBase "CN=Users,DC=dev,DC=cyberbotic,DC=io" | ? { $_.ActiveDirectoryRights -match "GenericAll|WriteProperty|WriteDacl" -and $_.SecurityIdentifier -match "S-1-5-21-3263068140-2042698922-2891547269-[\d]{4,10}" } | select ObjectDN, ActiveDirectoryRights, SecurityIdentifier | fl


```